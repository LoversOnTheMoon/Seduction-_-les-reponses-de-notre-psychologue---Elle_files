var passmediaHandler = function () {
        const closeDelay = 10000;

        var token = null,
            animation = null
        ;

        /**
         *
         * @param cname
         * @returns {string|null}
         */
        function readCookie(cname) {
            var c, i,
                name = cname.concat('='),
                ca = document.cookie.split(';')
            ;

            for (i = 0; i < ca.length; i += 1) {
                c = ca[i];
                while (c.charAt(0) === ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) === 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return null;
        }

        /**
         *
         * @returns {string}
         */
        function isUserLogged() {
            return readCookie('lauser_id');
        }

        /**
         *
         */
        function onPageLoad() {
            var params = {
                    'onLogin': SSOGESTE_Onlogin
                },
                pmToken = readCookie('pm_token'),
                hash = document.location.hash
            ;

            if (hash === '#verificationPM') {
                SSOGESTE_Onlogin();
            } else if (pmToken) {
                SSOGESTE_callback_accountInfo({id_token: pmToken});
            } else {
                try {
                    gigya.accounts.addEventHandlers(params);
                } catch (e) {
                    console.log("Le service de sso passmedia est temporairement indisponible.")
                }
            }
        }

        /**
         *
         * @constructor
         */
        function SSOGESTE_Onlogin() {
            var params = {
                    'fields': 'profile.email,data.mailVerified',
                    'callback': SSOGESTE_callback_accountInfo
                }
            ;

            gigya.accounts.getJWT(params);
        }

        /**
         *
         * @param response
         * @constructor
         */
        function SSOGESTE_callback_accountInfo(response) {
            var hash = document.location.hash,
                xhttp
            ;

            token = response.id_token;
            document.location.hash = '';
            if (token) {
                xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        var result = JSON.parse(xhttp.responseText);
                        handleModalAction(result);
                    }
                };
                xhttp.withCredentials = true;
                xhttp.open('POST', passmedia_profile_url + '/passmedia/accountInfo', true);
                xhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                // passer l'id_token pour en vérifier l'authenticité et extraire les informations
                xhttp.send('token=' + token + '&pmhash=' + hash);
            }
        }

        /**
         *
         * @param response
         */
        function handleModalAction(response) {
            switch (response.type) {
                case "logged":
                    ssogeste_onlogin_callback();
                    isReady();
                    break;
                case 'autocreation':
                    autocreation()
                    break;
                case 'reconciliation':
                    reconciliation(response);
                    isReady();
                    break;
                case 'autoreconciliation':
                    // Il faut le token pour pouvoir reconcilier les deux comptes
                    autoreconciliation(response);
                    break;
                default:
                    break;
            }
        }

        /**
         *
         * @param response
         */
        function reconciliation(response) {
            const p = new Promise(function (resolve, reject) {
                createModale(response);
                resolve();
            })

            p.then(() => {
                document.getElementById("passmedia-close-modale").addEventListener('click', function () {
                    capping();
                });

                document.getElementById('connectPassmedia').addEventListener('click', function () {
                    capping(function () {
                        document.location = passmedia_profile_url + "/login?redirect_url=" + encodeURIComponent(document.location.href);
                    });
                });

                document.getElementById("btn--checkemail").addEventListener("click", function () {
                    try {
                        gigya.accounts.resendVerificationCode({email: response.profile_email});
                        document.getElementById("btn--checkemail").addEventListener("click", function () {
                        });
                        capping(function () {
                            document.getElementById("modal-open").checked = false;
                        });

                        // todo: notif d'envoi de mail
                    } catch (e) {
                        console.error("L'envoi par mail de vérification est temporairement indisponible.")
                    }
                });

                setTimeout(() => {
                    document.getElementById("modal-open").checked = true;
                }, 20);

            });
        }

        /**
         *
         */
        function autocreation() {
            handleClickModalAutocreation('autocreation');
        }

        /**
         *
         * @param response
         */
        function autoreconciliation(response) {
            handleClickModalAutocreation('autoreconciliation')
        }

        /**
         *
         * @param type
         */
        function handleClickModalAutocreation(type) {
            const p = new Promise(function (resolve, reject) {
                createNotification();
                resolve();
            })

            p.then(() => {
                var animation = document.getElementById("PassMedia--progress"),
                    isAccepted = null,
                    accept = function (e) {
                        e.stopPropagation();

                        animation.removeEventListener("webkitAnimationEnd", accept);
                        animation.removeEventListener("animationend", accept);

                        if (isAccepted == null) {
                            document.getElementById('PassMedia-notification').classList.add('Passmedia--hide')
                            // On prend le meme element que le ok car c'est le meme traitement si il ne clique sur rien
                            createUser(type);
                        }
                    }
                ;

                document.getElementById('PassMedia-close').addEventListener('click', function () {
                    isAccepted = false;
                    this.parentNode.parentNode.classList.add('Passmedia--hide');
                    createUser(type);
                });

                document.getElementById('closePassmedia').addEventListener('click', function () {
                    animation.removeEventListener("webkitAnimationEnd", accept);
                    animation.removeEventListener("animationend", accept);

                    isAccepted = false;
                    this.parentNode.parentNode.classList.add('Passmedia--hide');
                    isReady();
                    capping();
                })

                document.getElementById('redirectTo').addEventListener('click', function (e) {
                    e.preventDefault();

                    animation.removeEventListener("webkitAnimationEnd", accept);
                    animation.removeEventListener("animationend", accept);
                    this.parentNode.parentNode.classList.add('Passmedia--hide');
                    isAccepted = true
                    createUser(type);
                });

                document.getElementById('redirectToCgu').addEventListener('click', function (e) {
                    e.preventDefault();

                    animation.removeEventListener("webkitAnimationEnd", accept);
                    animation.removeEventListener("animationend", accept);

                    if (passmedia_client_gcu_link) {
                        document.location.href = passmedia_client_gcu_link;
                    }
                });

                // Code for Chrome, Safari and Opera
                animation.addEventListener("webkitAnimationEnd", accept);

                // Standard syntax
                animation.addEventListener("animationend", accept);
            });
        }

        /**
         *
         * @param cb
         */
        function capping(cb) {
            var xhttp = new XMLHttpRequest();

            xhttp.open('post', passmedia_profile_url + '/passmedia/optout', true);
            xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    if (cb) {
                        cb();
                    }
                }
            };

            // passer l'id_token pour en vérifier l'authenticité et extraire les informations
            xhttp.send('token=' + token);

        }

        /**
         *
         * @param type
         */
        function createUser(type) {
            var xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function (response) {
                if (this.readyState == 4 && this.status == 200) {
                    var response = JSON.parse(this.response)
                    if (response.type === 'logged') {
                        isReady();
                        ssogeste_onlogin_callback();
                    }
                }
            };

            if (type === 'autocreation') {
                xhttp.open('post', passmedia_profile_url + '/passmedia/create', true);
            } else if (type === 'autoreconciliation') {
                xhttp.open('post', passmedia_profile_url + '/passmedia/update', true);
            }

            xhttp.withCredentials = true;
            xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            // passer l'id_token pour en vérifier l'authenticité et extraire les informations
            xhttp.send('token=' + token);
        }

        /**
         *
         * @param response
         */
        function createModale(response) {
            var div = document.createElement('div'),
                html = "<div id='PassMedia-optout'>\n" +
                    "                <div class='PassMedia-content'>\n" +
                    "                    <input type='radio' name='modal' value='open' id='modal-open' class='modal-radio' />\n" +
                    "                    <div class='modal-label overlay'></div>\n" +
                    "                    <div class='PassMedia-modal'>\n" +
                    "                        <div class='PassMedia-sub-content'>\n" +
                    "                            <div class='wrap'>\n" +
                    "                                <div class='top'>\n" +
                    getSvg() +
                    "                                    <label class='modal-label close-btn' id='user-event'>\n" +
                    "                                        <input type='radio' name='modal' value='close' class='modal-radio' id='passmedia-close-modale'/>\n" +
                    "                                    </label>\n" +
                    "                                </div>\n" +
                    "                                <h2>Session PassMedia détectée</h2>\n" +
                    "                                <p>Vous disposez déjà d'un compte <span>" + oidc_client_name + "</span> avec l'adresse email " + response.profile_email + "</p>\n" +
                    "<p>Pour associer votre compte PassMedia avec votre compte <span>" + oidc_client_name + "</span> en toute sécurité, validez votre e-mail.</p>\n" +
                    " <button class='close_notification' id='btn--checkemail' title='demande vérification'>recevoir un nouvel email de vérification</button>\n" +
                    "<p class='overlined'><span>ou</span></p><p>Connectez-vous manuellement à votre compte <span>" + oidc_client_name + "</span></p>\n" +
                    "                                <button class='close_notification' id='connectPassmedia' title='ME CONNECTER'>ME CONNECTER</button>\n" +
                    "                            </div>\n" +
                    "                        </div>\n" +
                    "                    </div>\n" +
                    "                </div>\n" +
                    "            </div>"
            ;
            div.innerHTML = html;

            document.body.appendChild(div);
        }

        /**
         *
         */
        function createNotification() {
            var div = document.createElement('div');

            div.innerHTML = '<div id="PassMedia-notification" class="Passmedia">\n' +
                '\n' +
                '    <div id="ImgPassMedia-notification" class="img-fluid">\n' +
                getNotificationSvg() +
                '    </div>\n' +
                '    <div class="txt">\n' +
                '        <i class="close-times" id="PassMedia-close">\n' +
                '\n' +
                '        </i>\n' +
                '        <span>Félicitations,</span><span>vous bénéficiez dès à présent </span><span>d’un accès connecté à </span><span class="bold">' + oidc_client_name + '</span></div>\n' +
                '    <div class="wrap-buttons__PassMedia">\n' +
                '        <button class="close_notification" id="closePassmedia" title=\'Click to Close\'>NE PAS ME CONNECTER</button>\n' +
                '        <a href="##" id="redirectTo">OK</a>\n' +
                '    </div>\n' +
                '<div class="PassMedia--CGU">Consultez les <a href="##" id="redirectToCgu">CGU de <span class="bold">' + oidc_client_name + '</span></a></div>\n' +
                '<div class="PassMedia_meter"><span><span class="PassMedia_progress" id="PassMedia--progress"></span></span></div>\n' +
                '\n' +
                '</div>'


            document.body.appendChild(div);
        }

        /**
         *
         */
        function isReady() {
            // Crée l'événement
            var event = document.createEvent('Event');
            event.initEvent('passmedia_ready', true, true);
            document.dispatchEvent(event);
        }

        /**
         *
         * @returns {string}
         */
        function getNotificationSvg() {
            return '<svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg">\n' +
                '            <mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="1" y="1" width="26" height="26">\n' +
                '                <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5761 2.36701C9.53641 2.39485 6.68328 3.60696 4.53087 5.78711C2.35347 7.99304 1.15454 10.9263 1.15454 14.0461C1.15454 17.1657 2.35347 20.0987 4.53087 22.3049C6.70878 24.5106 9.60408 25.7255 12.6835 25.7255C15.7628 25.7255 18.6581 24.5106 20.8358 22.3049C23.0129 20.0987 24.2124 17.1657 24.2124 14.0461H22.2001C22.2001 16.6214 21.21 19.0423 19.4126 20.8631C17.6153 22.684 15.2255 23.6871 12.6835 23.6871C10.1414 23.6871 7.7514 22.684 5.95403 20.8631C4.15665 19.0423 3.16655 16.6214 3.16655 14.0461C3.16655 11.4709 4.15665 9.04974 5.95403 7.22887C7.72615 5.43351 10.0743 4.43351 12.5761 4.40567V5.88196L14.9237 3.57784L12.5761 1.27371V2.36701ZM12.5979 7.60696C11.3212 7.65077 10.3384 8.02036 9.67655 8.70541C9.23365 9.16392 8.98947 9.8 9.00613 10.4467L8.99326 20.6284H11.2197L11.1851 10.5593C11.3434 9.58247 12.7514 9.41289 12.7638 9.4116C13.8119 9.30748 14.621 9.51727 15.1682 10.0356C15.9691 10.7938 15.9436 11.9776 15.9429 11.9933C15.9323 13.0809 15.6032 13.8317 14.9657 14.2255C14.0854 14.7686 12.5317 14.5727 12.516 14.5704L12.3176 14.5443V16.3394L12.4971 16.3515C13.1973 16.3992 13.9064 16.3861 14.6053 16.3134C15.7323 16.1866 16.5949 15.724 17.1693 14.9384C18.2975 13.3969 17.9185 11.1727 17.8935 11.034C17.6589 9.40876 16.6615 8.30052 15.0086 7.82887C14.2975 7.62603 13.6157 7.58196 13.1579 7.58196C12.8486 7.58196 12.6415 7.60206 12.5979 7.60696Z" fill="white"/>\n' +
                '            </mask>\n' +
                '            <g mask="url(#mask0)">\n' +
                '                <path fill-rule="evenodd" clip-rule="evenodd" d="M-0.342896 27.2536H25.7097V-0.254379H-0.342896V27.2536Z" fill="white"/>\n' +
                '            </g>\n' +
                '            <path d="M12.5761 4.40577H12.8261V4.15297L12.5734 4.15579L12.5761 4.40577ZM5.95403 7.22897L6.13195 7.40459L6.13195 7.40459L5.95403 7.22897ZM5.95403 20.8632L5.77611 21.0389L5.77613 21.0389L5.95403 20.8632ZM19.4126 20.8632L19.5905 21.0389L19.5906 21.0389L19.4126 20.8632ZM22.2001 14.046V13.796H21.9501V14.046H22.2001ZM24.2124 14.046H24.4624V13.796H24.2124V14.046ZM20.8358 22.3047L21.0137 22.4804L21.0137 22.4804L20.8358 22.3047ZM4.53112 22.3047L4.35319 22.4804L4.35322 22.4804L4.53112 22.3047ZM4.53112 5.78721L4.35321 5.61158L4.3532 5.61159L4.53112 5.78721ZM12.5761 2.36685L12.5785 2.61684L12.8261 2.61455V2.36685H12.5761ZM12.5761 1.27381L12.7513 1.09539L12.3261 0.678146V1.27381H12.5761ZM14.9237 3.57793L15.0989 3.75636L15.2806 3.57793L15.0989 3.39951L14.9237 3.57793ZM12.5761 5.88206H12.3261V6.47772L12.7513 6.06048L12.5761 5.88206ZM11.2197 20.6285V20.8785H11.4705L11.4696 20.6276L11.2197 20.6285ZM8.99351 20.6285L8.74351 20.6281L8.7432 20.8785H8.99351V20.6285ZM9.00613 10.4465L9.25622 10.4468L9.25605 10.44L9.00613 10.4465ZM9.67655 8.70551L9.85631 8.87925L9.85638 8.87918L9.67655 8.70551ZM12.5979 7.6068L12.6064 7.85665L12.6154 7.85635L12.6243 7.85539L12.5979 7.6068ZM15.0086 7.82897L14.94 8.06936L14.94 8.06937L15.0086 7.82897ZM17.8938 11.0341L17.6462 11.0699L17.6477 11.0781L17.8938 11.0341ZM17.1693 14.9385L16.9676 14.7909L16.9675 14.7909L17.1693 14.9385ZM14.6053 16.3135L14.6312 16.5622L14.6333 16.5619L14.6053 16.3135ZM12.4971 16.3516L12.5141 16.1022L12.5139 16.1022L12.4971 16.3516ZM12.3176 16.3395H12.0676V16.5732L12.3007 16.589L12.3176 16.3395ZM12.3176 14.5442L12.3504 14.2963L12.0676 14.2589V14.5442H12.3176ZM12.5163 14.5705L12.5495 14.3227L12.5491 14.3226L12.5163 14.5705ZM14.9659 14.2254L15.0972 14.4381L15.0973 14.4381L14.9659 14.2254ZM15.9431 11.9931L15.6932 11.9851L15.6931 11.9906L15.9431 11.9931ZM15.1684 10.0354L15.3403 9.85389L15.3403 9.85386L15.1684 10.0354ZM12.7638 9.41144L12.739 9.16258L12.7328 9.16337L12.7638 9.41144ZM11.1851 10.5591L10.9383 10.5191L10.935 10.5394L10.9351 10.56L11.1851 10.5591ZM12.5734 4.15579C10.0051 4.18436 7.59418 5.21143 5.7761 7.05334L6.13195 7.40459C7.85813 5.65578 10.1434 4.68285 12.5789 4.65575L12.5734 4.15579ZM5.77611 7.05334C3.93222 8.92133 2.91655 11.4057 2.91655 14.046H3.41655C3.41655 11.5363 4.38108 9.17835 6.13195 7.40459L5.77611 7.05334ZM2.91655 14.046C2.91655 16.6865 3.93222 19.1709 5.77611 21.0389L6.13195 20.6876C4.38108 18.9139 3.41655 16.556 3.41655 14.046H2.91655ZM5.77613 21.0389C7.62036 22.9067 10.074 23.937 12.6835 23.937V23.437C10.2088 23.437 7.88295 22.461 6.13192 20.6876L5.77613 21.0389ZM12.6835 23.937C15.2929 23.937 17.7466 22.9067 19.5905 21.0389L19.2347 20.6876C17.484 22.461 15.1581 23.437 12.6835 23.437V23.937ZM19.5906 21.0389C21.4344 19.1709 22.4501 16.6865 22.4501 14.046H21.9501C21.9501 16.556 20.9856 18.9139 19.2347 20.6876L19.5906 21.0389ZM22.2001 14.296H24.2124V13.796H22.2001V14.296ZM23.9624 14.046C23.9624 17.1003 22.7888 19.9701 20.6579 22.1291L21.0137 22.4804C23.2376 20.227 24.4624 17.2308 24.4624 14.046H23.9624ZM20.6579 22.1291C18.5268 24.2875 15.6955 25.4754 12.6835 25.4754V25.9754C15.8302 25.9754 18.7894 24.7333 21.0137 22.4804L20.6579 22.1291ZM12.6835 25.4754C9.67119 25.4754 6.84007 24.2875 4.70903 22.1291L4.35322 22.4804C6.5775 24.7333 9.53647 25.9754 12.6835 25.9754V25.4754ZM4.70906 22.1291C2.57816 19.9701 1.40454 17.1003 1.40454 14.046H0.904541C0.904541 17.2308 2.12928 20.227 4.35319 22.4804L4.70906 22.1291ZM1.40454 14.046C1.40454 10.9914 2.57816 8.12164 4.70905 5.96284L4.3532 5.61159C2.12928 7.86465 0.904541 10.8609 0.904541 14.046H1.40454ZM4.70904 5.96284C6.81513 3.82935 9.60552 2.64432 12.5785 2.61684L12.5738 2.11686C9.4678 2.14557 6.55143 3.38477 4.35321 5.61158L4.70904 5.96284ZM12.8261 2.36685V1.27381H12.3261V2.36685H12.8261ZM12.401 1.45223L14.7486 3.75636L15.0989 3.39951L12.7513 1.09539L12.401 1.45223ZM14.7486 3.39951L12.401 5.70364L12.7513 6.06048L15.0989 3.75636L14.7486 3.39951ZM12.8261 5.88206V4.40577H12.3261V5.88206H12.8261ZM11.2197 20.3785H8.99351V20.8785H11.2197V20.3785ZM9.24351 20.6288L9.25613 10.4468L8.75613 10.4462L8.74351 20.6281L9.24351 20.6288ZM9.25605 10.44C9.24108 9.85923 9.46102 9.28824 9.85631 8.87925L9.49679 8.53177C9.00627 9.03928 8.73786 9.74097 8.75622 10.4529L9.25605 10.44ZM9.85638 8.87918C10.4596 8.25462 11.3719 7.89902 12.6064 7.85665L12.5893 7.35695C11.2704 7.40221 10.2172 7.78579 9.49672 8.53184L9.85638 8.87918ZM12.6243 7.85539C12.7216 7.84503 13.794 7.74224 14.94 8.06936L15.0772 7.58857C13.8395 7.23528 12.6918 7.34538 12.5714 7.35821L12.6243 7.85539ZM14.94 8.06937C15.7292 8.29452 16.3484 8.66747 16.7973 9.16619C17.2458 9.66438 17.5353 10.3003 17.6463 11.0698L18.1412 10.9984C18.0177 10.1427 17.6912 9.41185 17.169 8.83169C16.6472 8.25206 15.9412 7.83506 15.0772 7.58856L14.94 8.06937ZM17.6477 11.0781C17.6582 11.137 17.756 11.7066 17.7143 12.446C17.6725 13.1886 17.4914 14.0751 16.9676 14.7909L17.3711 15.0861C17.9755 14.2602 18.169 13.2636 18.2135 12.4741C18.2582 11.6813 18.1541 11.0696 18.1399 10.9901L17.6477 11.0781ZM16.9675 14.7909C16.4413 15.5106 15.6474 15.9444 14.5773 16.0651L14.6333 16.5619C15.8171 16.4285 16.7484 15.9376 17.3711 15.0861L16.9675 14.7909ZM14.5795 16.0648C13.8946 16.1361 13.1999 16.1489 12.5141 16.1022L12.4801 16.6011C13.1947 16.6497 13.9181 16.6363 14.6312 16.5622L14.5795 16.0648ZM12.5139 16.1022L12.3344 16.0901L12.3007 16.589L12.4803 16.6011L12.5139 16.1022ZM12.5676 16.3395V14.5442H12.0676V16.3395H12.5676ZM12.2848 14.792L12.4835 14.8183L12.5491 14.3226L12.3504 14.2963L12.2848 14.792ZM12.4831 14.8183C12.4995 14.8204 12.9068 14.8716 13.426 14.8522C13.9364 14.8333 14.5996 14.7451 15.0972 14.4381L14.8346 14.0126C14.4517 14.2489 13.8978 14.3343 13.4074 14.3526C12.9257 14.3705 12.5485 14.3225 12.5495 14.3227L12.4831 14.8183ZM15.0973 14.4381C15.8373 13.9811 16.1818 13.1271 16.1931 11.9956L15.6931 11.9906C15.6827 13.0344 15.3692 13.6825 14.8346 14.0126L15.0973 14.4381ZM16.193 12.0012C16.1937 11.9787 16.1998 11.6554 16.0995 11.2348C15.9995 10.8153 15.7887 10.2785 15.3403 9.85389L14.9965 10.2169C15.3492 10.5509 15.5259 10.9851 15.6131 11.3508C15.7001 11.7155 15.693 11.9919 15.6933 11.9851L16.193 12.0012ZM15.3403 9.85386C14.722 9.2685 13.8298 9.05433 12.7391 9.16266L12.7885 9.66022C13.7945 9.5603 14.5205 9.76624 14.9965 10.217L15.3403 9.85386ZM12.7328 9.16337C12.7329 9.16335 12.7302 9.16369 12.7262 9.1642C12.7223 9.16471 12.7171 9.16541 12.7106 9.16633C12.6977 9.16816 12.6798 9.17085 12.6576 9.17456C12.6134 9.18196 12.5517 9.19347 12.4781 9.21043C12.3315 9.24415 12.1334 9.30034 11.9283 9.39081C11.5284 9.56715 11.038 9.9041 10.9383 10.5191L11.4318 10.5991C11.4905 10.2373 11.7832 10.0012 12.13 9.84831C12.2982 9.77415 12.4643 9.72667 12.5902 9.69768C12.6528 9.68328 12.7044 9.67368 12.7401 9.66771C12.7579 9.66473 12.7717 9.66267 12.7808 9.66138C12.7897 9.66012 12.7942 9.65957 12.7948 9.65951L12.7328 9.16337ZM10.9351 10.56L10.9697 20.6293L11.4696 20.6276L11.4351 10.5583L10.9351 10.56Z" fill="white"/>\n' +
                '        </svg>';
        }

        /**
         *
         * @returns {string}
         */
        function getSvg() {
            return "<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='125' viewBox='0 0 530 125'>\n" +
                "    <defs>\n" +
                "        <linearGradient id='a' x1='-232.041%' x2='1073.11%' y1='57.085%' y2='24.677%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='b' x1='-340.841%' x2='964.311%' y1='59.785%' y2='27.378%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='c' x1='-369.844%' x2='676.578%' y1='63.5%' y2='29.862%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='d' x1='-716.991%' x2='805.686%' y1='66.946%' y2='33.308%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='e' x1='-691.133%' x2='552.519%' y1='69.228%' y2='35.59%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='f' x1='-2828.72%' x2='1490.146%' y1='72.424%' y2='38.785%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='g' x1='-748.311%' x2='338.818%' y1='75.244%' y2='41.606%'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#2CD2D7'/>\n" +
                "        </linearGradient>\n" +
                "        <linearGradient id='h' x1='.077%' x2='146.118%' y1='49.26%' y2='51.769%'>\n" +
                "            <stop offset='0%' stop-color='#4A97C5'/>\n" +
                "            <stop offset='55.12%' stop-color='#6561B5'/>\n" +
                "            <stop offset='100%' stop-color='#6C54B2'/>\n" +
                "        </linearGradient>\n" +
                "        <radialGradient id='i' cx='47.525%' cy='39.968%' r='116.662%' fx='47.525%' fy='39.968%' gradientTransform='matrix(1 0 0 .72727 0 .109)'>\n" +
                "            <stop offset='0%' stop-color='#6C54B2'/>\n" +
                "            <stop offset='100%' stop-color='#4A97C5'/>\n" +
                "        </radialGradient>\n" +
                "    </defs>\n" +
                "    <g fill='none' fill-rule='nonzero'>\n" +
                "        <path fill='url(#a)' d='M23.527 65.935c-4.137 0-8.209-.776-12.28-2.264C7.173 62.182 3.49 59.918.322 56.876l8.08-9.77a29.982 29.982 0 0 0 7.497 4.723c2.715 1.23 5.43 1.812 8.08 1.812 2.972 0 5.17-.517 6.592-1.617 1.422-1.1 2.198-2.589 2.198-4.465 0-.97-.194-1.812-.647-2.524-.388-.711-1.034-1.359-1.81-1.876-.775-.518-1.745-1.035-2.908-1.553-1.099-.453-2.392-1.035-3.684-1.618l-8.209-3.494a23.259 23.259 0 0 1-4.653-2.523c-1.487-1.036-2.844-2.265-4.072-3.624-1.164-1.359-2.133-2.976-2.844-4.853-.711-1.812-1.034-3.882-1.034-6.212 0-2.588.517-4.982 1.615-7.311 1.1-2.265 2.65-4.271 4.654-6.018 2.004-1.682 4.33-3.041 7.11-4.012C19.002.971 22.04.518 25.337.518c3.684 0 7.303.711 10.858 2.135a27.863 27.863 0 0 1 9.437 6.212l-7.24 8.994c-2.068-1.618-4.136-2.847-6.204-3.688-2.068-.842-4.33-1.295-6.851-1.295-2.457 0-4.396.518-5.817 1.489-1.422.97-2.198 2.394-2.198 4.206 0 .97.258 1.811.71 2.458.453.647 1.164 1.295 2.005 1.812.84.518 1.874 1.035 3.037 1.553 1.164.453 2.392 1.035 3.75 1.618l8.078 3.3c3.878 1.553 6.916 3.688 9.114 6.406 2.197 2.717 3.36 6.276 3.36 10.74 0 2.654-.516 5.113-1.615 7.507-1.034 2.33-2.585 4.4-4.654 6.211-2.003 1.748-4.524 3.171-7.497 4.271-2.973.97-6.334 1.488-10.083 1.488z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#b)' d='M74.782 65.935c-4.137 0-8.209-.776-12.28-2.264-4.073-1.489-7.757-3.753-10.924-6.795l8.08-9.77a29.982 29.982 0 0 0 7.497 4.723c2.715 1.23 5.43 1.812 8.08 1.812 2.972 0 5.17-.517 6.592-1.617 1.422-1.1 2.197-2.589 2.197-4.465 0-.97-.194-1.812-.646-2.524-.388-.711-1.034-1.359-1.81-1.876-.775-.518-1.745-1.035-2.908-1.553-1.099-.453-2.392-1.035-3.684-1.618l-8.209-3.494a23.259 23.259 0 0 1-4.654-2.523c-1.486-1.036-2.843-2.265-4.072-3.624-1.163-1.359-2.132-2.976-2.843-4.853-.711-1.812-1.035-3.882-1.035-6.212 0-2.588.517-4.982 1.616-7.311 1.099-2.265 2.65-4.271 4.654-6.018 2.004-1.682 4.33-3.041 7.11-4.012C70.257.971 73.295.518 76.59.518c3.685 0 7.304.711 10.859 2.135a27.863 27.863 0 0 1 9.437 6.212l-7.24 8.994c-2.068-1.618-4.136-2.847-6.204-3.688-2.069-.842-4.33-1.295-6.852-1.295-2.456 0-4.395.518-5.817 1.489-1.422.97-2.197 2.394-2.197 4.206 0 .97.258 1.811.71 2.458.453.647 1.164 1.295 2.004 1.812.84.518 1.875 1.035 3.038 1.553 1.164.453 2.392 1.035 3.749 1.618l8.08 3.3c3.877 1.553 6.915 3.688 9.113 6.406 2.197 2.717 3.36 6.276 3.36 10.74 0 2.654-.516 5.113-1.615 7.507-1.034 2.33-2.586 4.4-4.654 6.211-2.003 1.748-4.524 3.171-7.497 4.271-3.038.97-6.335 1.488-10.083 1.488z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#c)' d='M108.327 64.77V1.748h15.512l10.148 28.018a120.907 120.907 0 0 1 1.81 5.759c.581 1.94 1.163 3.882 1.81 5.823h.387c.646-1.941 1.228-3.882 1.81-5.823.517-1.942 1.163-3.883 1.81-5.76l9.953-28.017h15.448v63.024h-12.927v-23.1c0-1.553.064-3.236.194-5.112.129-1.877.258-3.753.452-5.63l.582-5.629c.194-1.812.388-3.559.582-5.047h-.388L150.404 35.2l-8.984 24.07h-7.821l-8.984-24.07-5.042-14.947h-.388c.194 1.553.388 3.235.582 5.047.194 1.812.388 3.688.582 5.63.194 1.876.323 3.752.452 5.629.13 1.876.194 3.559.194 5.112v23.1h-12.668z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#d)' d='M180.523 64.77V1.748h39.362v11.97h-25.207V26.4h21.459v11.906h-21.459V52.8h26.177v11.97h-40.332z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#e)' d='M232.683 64.77V1.748h17.774c4.848 0 9.178.582 13.056 1.812 3.878 1.23 7.175 3.106 9.954 5.63 2.78 2.523 4.912 5.758 6.399 9.705 1.486 3.947 2.197 8.606 2.197 14.041 0 5.436-.71 10.094-2.197 14.106-1.487 4.012-3.555 7.312-6.27 9.9-2.714 2.588-5.946 4.53-9.695 5.824-3.749 1.294-7.95 1.94-12.603 1.94h-18.615v.066zm14.22-11.517h2.714c2.715 0 5.17-.324 7.304-1.035a13.906 13.906 0 0 0 5.623-3.43c1.551-1.553 2.78-3.623 3.62-6.212.84-2.588 1.292-5.758 1.292-9.576 0-3.753-.452-6.859-1.293-9.447-.84-2.524-2.068-4.594-3.62-6.082-1.55-1.489-3.425-2.589-5.622-3.236-2.198-.647-4.654-.97-7.304-.97h-2.715v39.988z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#f)' d='M293.698 64.77V1.748h14.22v63.024h-14.22z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#g)' d='M314.251 64.77l19.714-63.023h17.063l19.713 63.024h-15.06l-3.877-14.947h-19.197L328.73 64.77h-14.478zm22.816-31.9l-1.551 5.824h13.444l-1.422-5.823c-.905-3.171-1.745-6.536-2.586-10.03a476.96 476.96 0 0 0-2.52-10.223h-.388c-.776 3.364-1.551 6.794-2.392 10.288-.84 3.494-1.68 6.794-2.585 9.965z' transform='translate(159 32)'/>\n" +
                "        <path fill='url(#h)' d='M64.367 5.965L64.432 0l11.937 11.93-12.262 11.605.065-7.067s-18.23-2.658-34.58 9.53c0 0-10.185 7.521-15.05 19.321 0 0-3.05 6.094-3.958 16.014 0 0-1.298 9.984 2.465 20.034 0 0 3.179 10.308 11.743 18.866 0 0 4.67 5.382 14.467 9.92 0 0 9.667 4.474 19.463 4.344 0 0 10.316.519 21.345-5.381 0 0 9.407-4.668 16.09-14.264 0 0 4.411-4.409 10.834-24.766l11.159-35.724h17.127L155 97.575h-15.116l-3.893-15.041h-19.268s-3.893 11.93-13.43 22.627c0 0-8.045 9.336-18.555 13.874 0 0-10.056 5.706-25.886 5.965 0 0-12.586 0-23.485-5.122 0 0-11.289-4.603-19.528-13.81 0 0-7.98-7.78-12.91-21.654 0 0-3.115-8.429-2.92-20.034 0 0-.13-10.244 4.541-22.303 0 0 4.412-10.697 12.91-18.931 0 0 6.294-6.743 16.48-11.54.13-.195 13.559-6.873 30.427-5.641zm68.77 65.288l-6.553-26.193h-.39l-6.487 26.257 13.43-.064z'/>\n" +
                "        <path fill='url(#i)' d='M45.064 99L45 46.162s-.129-8.35 9.338-11.48c0 0 5.023-2.023 14.038-1.632 0 0 9.273.196 14.811 3.327 0 0 5.152 2.348 7.792 7.371 0 0 1.803 2.61 1.997 8.48 0 0 .257 5.415-.902 9.068 0 0-.773 4.175-4.572 8.415 0 0-3.67 4.5-10.432 5.87 0 0-5.796 1.436-15.005.98l.065-11.808s4.7 1.044 9.724-.13c0 0 6.375-1.044 7.148-6.85 0 0 .837-4.5-.387-6.719 0 0-1.288-3.653-6.31-4.696 0 0-3.671-1.044-10.047-.261 0 0-1.803.326-2.447 2.544 0 0-.193.783-.193 1.63V99H45.064z'/>\n" +
                "    </g>\n" +
                "</svg>\n";
        }

        if (!isUserLogged()) {
            var script = document.createElement('script'),
                link = document.createElement('link')
            ;

            script.src = "https://cdns.gigya.com/js/gigya.js?apiKey=" + oidc_client_api_key;
            script.type = "text/javascript";
            script.onload = onPageLoad;

            link.type = "text/css";
            link.rel = "stylesheet";
            link.href = passmedia_profile_resource_location;

            document.head.appendChild(script);
            document.head.appendChild(link);

            if (typeof passmedia_client_resource_location !== 'undefined') {
                link = document.createElement('link');
                link.type = "text/css";
                link.rel = "stylesheet";
                link.href = passmedia_client_resource_location;
                document.head.appendChild(link);
            }
        } else {
            isReady();
        }
    }
;
